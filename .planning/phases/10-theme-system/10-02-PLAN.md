---
phase: 10-theme-system
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - src/components/BottomNav.tsx
  - src/app/(auth)/layout.tsx
  - src/app/(auth)/login/page.tsx
  - src/app/(auth)/register/page.tsx
  - src/app/dashboard/page.tsx
  - src/app/vehicles/page.tsx
  - src/app/vehicles/new/page.tsx
  - src/app/vehicles/[id]/page.tsx
  - src/app/vehicles/[id]/edit/page.tsx
  - src/app/vehicles/[id]/fillups/page.tsx
  - src/app/fillups/new/page.tsx
  - src/app/fillups/[id]/edit/page.tsx
  - src/app/import/page.tsx
  - src/app/groups/page.tsx
  - src/app/groups/new/page.tsx
  - src/app/groups/join/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can toggle between light and dark themes"
    - "All application pages display correctly in both themes"
    - "BottomNav respects current theme"
    - "Theme toggle is accessible from navigation"
  artifacts:
    - path: "src/components/BottomNav.tsx"
      provides: "Theme-aware bottom navigation with toggle"
      contains: "useTheme"
    - path: "src/app/(auth)/layout.tsx"
      provides: "Dark mode support for auth wrapper"
      contains: "dark:"
    - path: "src/app/(auth)/login/page.tsx"
      provides: "Dark mode styled login form"
      contains: "dark:"
    - path: "src/app/dashboard/page.tsx"
      provides: "Dark mode styled dashboard"
      contains: "dark:"
  key_links:
    - from: "src/components/BottomNav.tsx"
      to: "ThemeContext"
      via: "useTheme hook"
      pattern: "useTheme.*setTheme"
---

<objective>
Add theme toggle to BottomNav and apply dark mode styles to all pages.

Purpose: Give users control over theme preference and ensure all pages look correct in both themes.
Output: Theme toggle button, theme-aware BottomNav, dark mode styled pages across entire app.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/BottomNav.tsx
@src/app/(auth)/layout.tsx
@src/app/(auth)/login/page.tsx
@src/app/(auth)/register/page.tsx
@src/contexts/ThemeContext.tsx
@src/app/dashboard/page.tsx
@src/app/vehicles/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add theme toggle to BottomNav</name>
  <files>src/components/BottomNav.tsx</files>
  <action>
Update BottomNav to:

1. Import useTheme from '@/contexts/ThemeContext'
2. Add a theme toggle button as a 5th nav item (after Profile)
   - Use sun icon for light mode, moon icon for dark mode
   - Label: "Theme"
   - On tap: cycle through light -> dark -> system -> light
   - Show current state visually (filled icon when active)
3. Update nav background to be theme-aware:
   - Light: `bg-white border-gray-200`
   - Dark: `dark:bg-slate-900 dark:border-slate-700`
4. Update nav item colors to be theme-aware:
   - Active: `text-green-600 dark:text-green-400`
   - Inactive: `text-gray-500 dark:text-slate-400 hover:text-gray-700 dark:hover:text-slate-200`

Theme toggle should NOT be a navigation link - it's a button that calls setTheme().
Keep the action button (Add Fillup) styling as-is with green background.
  </action>
  <verify>
- BottomNav shows 5 items: Home, Vehicles, Add, Profile, Theme
- Tapping Theme cycles through modes
- Nav background changes between light/dark themes
- Icons change appearance based on current theme
  </verify>
  <done>
BottomNav has theme toggle button and respects current theme for its own styling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add dark mode styles to auth pages</name>
  <files>src/app/(auth)/layout.tsx, src/app/(auth)/login/page.tsx, src/app/(auth)/register/page.tsx</files>
  <action>
Update auth layout (src/app/(auth)/layout.tsx):
- Change `bg-gray-50` to `bg-gray-50 dark:bg-gray-900`

Update login page (src/app/(auth)/login/page.tsx):
- Card: `bg-white` -> `bg-white dark:bg-gray-800`
- Title: `text-gray-900` -> `text-gray-900 dark:text-white`
- Labels: `text-gray-700` -> `text-gray-700 dark:text-gray-300`
- Inputs: Add `dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400`
- Footer text: `text-gray-600` -> `text-gray-600 dark:text-gray-400`
- Keep error box as red (works in both themes)
- Keep blue button as-is (works in both themes)

Update register page (src/app/(auth)/register/page.tsx):
- Apply same dark mode patterns as login page
- Card, title, labels, inputs, footer text all need dark variants
  </action>
  <verify>
- Visit /login in dark mode - form is readable with proper contrast
- Visit /register in dark mode - form is readable with proper contrast
- Input fields are visible and usable in both themes
- Text has sufficient contrast in both themes
  </verify>
  <done>
Auth pages (login, register) display correctly in both light and dark themes.
  </done>
</task>

<task type="auto">
  <name>Task 3: Audit and update main app pages for dark mode</name>
  <files>src/app/dashboard/page.tsx, src/app/vehicles/page.tsx, src/app/vehicles/new/page.tsx, src/app/vehicles/[id]/page.tsx, src/app/vehicles/[id]/edit/page.tsx, src/app/vehicles/[id]/fillups/page.tsx, src/app/fillups/new/page.tsx, src/app/fillups/[id]/edit/page.tsx, src/app/import/page.tsx, src/app/groups/page.tsx, src/app/groups/new/page.tsx, src/app/groups/join/page.tsx</files>
  <action>
Audit each main app page for dark mode support. Many may already have some `dark:` classes from Tailwind. For each page, ensure:

1. **Background colors**: All `bg-white` and `bg-gray-*` should have `dark:bg-gray-800` or `dark:bg-gray-900` variants
2. **Text colors**: All `text-gray-*` should have `dark:text-gray-*` variants for proper contrast
3. **Border colors**: All `border-gray-*` should have `dark:border-gray-*` variants
4. **Card/container backgrounds**: Ensure cards stand out from page background in both themes
5. **Input fields**: Ensure form inputs have `dark:bg-gray-700 dark:border-gray-600 dark:text-white` where needed

Pages to update (apply consistent patterns):

**Dashboard (src/app/dashboard/page.tsx):**
- Page background, stat cards, vehicle cards need dark variants

**Vehicles list (src/app/vehicles/page.tsx):**
- Vehicle cards, empty state, text colors

**Vehicle detail (src/app/vehicles/[id]/page.tsx):**
- Stats display, fillup list, action buttons

**Vehicle forms (new, edit):**
- Form container, labels, inputs, select dropdowns

**Fillups pages (list, new, edit):**
- Fillup cards/rows, form inputs, date pickers

**Import page:**
- Instructions text, file input styling, preview table

**Groups pages:**
- Group cards, member lists, join/create forms

Use same dark mode color patterns established in auth pages:
- Cards: `dark:bg-gray-800`
- Page background: `dark:bg-gray-900`
- Primary text: `dark:text-white`
- Secondary text: `dark:text-gray-300` or `dark:text-gray-400`
- Borders: `dark:border-gray-700`
- Inputs: `dark:bg-gray-700 dark:border-gray-600`
  </action>
  <verify>
- Visit /dashboard in both light and dark mode - all elements readable
- Visit /vehicles in both themes - vehicle cards display correctly
- Visit /vehicles/new in both themes - form is usable
- Visit /fillups/new in both themes - form is usable
- Visit /import in both themes - instructions and upload area visible
- Visit /groups in both themes - group cards display correctly
- No white/bright elements jarring against dark background
- No dark text on dark backgrounds (contrast issues)
  </verify>
  <done>
All main application pages (dashboard, vehicles, fillups, import, groups) display correctly in both light and dark themes with consistent styling.
  </done>
</task>

<task type="auto">
  <name>Task 4: Verify and test complete theme flow</name>
  <files>None (testing only)</files>
  <action>
Run the dev server and verify the complete theme system:

1. Start fresh (clear localStorage): localStorage.removeItem('theme')
2. Verify system preference is detected
3. Use theme toggle in BottomNav to switch to light
4. Verify localStorage.getItem('theme') returns 'light'
5. Refresh page - should stay light
6. Toggle to dark - verify dark class on html, localStorage updated
7. Toggle to system - verify follows system preference
8. Visit /login, /register - verify dark mode works
9. Visit /dashboard - verify dark mode works
10. Visit /vehicles, /vehicles/new - verify dark mode works
11. Visit /fillups/new - verify dark mode works
12. Visit /groups - verify dark mode works
13. Visit /import - verify dark mode works

Run build to ensure no errors:
```
npm run build
```
  </action>
  <verify>
- Theme toggle works correctly
- localStorage persistence works
- All pages display correctly in both themes
- `npm run build` succeeds
  </verify>
  <done>
Complete theme system functional: toggle works, persistence works, all pages styled correctly.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` - start dev server
2. Open app in browser, toggle theme via BottomNav
3. Verify theme persists across page navigation
4. Verify theme persists across refresh
5. Visit /login and /register in both themes
6. Visit /dashboard in both themes
7. Visit /vehicles and vehicle detail pages in both themes
8. Visit /fillups/new in both themes
9. Visit /groups in both themes
10. Visit /import in both themes
11. Verify BottomNav styling changes with theme
12. `npm run build` succeeds
</verification>

<success_criteria>
- Theme toggle visible in BottomNav and functional
- BottomNav background/text colors change with theme
- Auth pages (login, register) have proper dark mode styles
- Dashboard page has proper dark mode styles
- Vehicles pages (list, detail, new, edit) have proper dark mode styles
- Fillups pages (list, new, edit) have proper dark mode styles
- Groups pages have proper dark mode styles
- Import page has proper dark mode styles
- Theme persists in localStorage and across refreshes
- Build succeeds without errors
- No visual regressions in any pages
</success_criteria>

<output>
After completion, create `.planning/phases/10-theme-system/10-02-SUMMARY.md`
</output>
